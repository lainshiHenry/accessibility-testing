"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const constants_1 = require("./constants");
const DISABLE_OTHER_EXTENSIONS_FLAG = '--disable-extensions-except';
const LOAD_EXTENSION_FLAG = '--load-extension';
function mergeChromeArgs(userArgs, { disableOtherExtensions }) {
    let loadExtensionFlagIndex = -1;
    let disableExtensionsFlagIndex = -1;
    for (const [index, arg] of userArgs.entries()) {
        if (arg.includes(LOAD_EXTENSION_FLAG) || arg.includes('load-extension')) {
            loadExtensionFlagIndex = index;
        }
        if (arg.includes(DISABLE_OTHER_EXTENSIONS_FLAG) ||
            arg.includes('disable-extensions-except')) {
            disableExtensionsFlagIndex = index;
        }
    }
    if (loadExtensionFlagIndex !== -1) {
        userArgs[loadExtensionFlagIndex] += `,${constants_1.PATH_TO_EXTENSION}`;
    }
    else {
        userArgs.push(`${LOAD_EXTENSION_FLAG}=${constants_1.PATH_TO_EXTENSION}`);
    }
    if (disableExtensionsFlagIndex !== -1) {
        userArgs[disableExtensionsFlagIndex] += `,${constants_1.PATH_TO_EXTENSION}`;
    }
    else if (disableOtherExtensions) {
        userArgs.push(`${DISABLE_OTHER_EXTENSIONS_FLAG}=${constants_1.PATH_TO_EXTENSION}`);
    }
    return userArgs;
}
exports.default = mergeChromeArgs;
//# sourceMappingURL=mergeChromeArgs.js.map